[
  {
    "objectID": "Mcali_analysis.html",
    "href": "Mcali_analysis.html",
    "title": "Mytilus californianus full range population genetic analysis",
    "section": "",
    "text": "Load the packages we will need for this analysis. Following these instructions to render this code to a website.\n\n\nCode\nlibrary(knitr)\nlibrary(ape)\nlibrary(pegas)\nlibrary(rlang)\nlibrary(adegenet)\nlibrary(rentrez)\nlibrary(tidyverse)\n#library(Biostrings)\n#library(BiocGenerics)\nlibrary(betapart)\nlibrary(strataG)\nlibrary(readxl)\nlibrary(ggmap)\nlibrary(raster)\nlibrary(phyclust)\nlibrary(phangorn)\nlibrary(colorspace)"
  },
  {
    "objectID": "Mcali_analysis.html#pegas-haplotype-network",
    "href": "Mcali_analysis.html#pegas-haplotype-network",
    "title": "Mytilus californianus full range population genetic analysis",
    "section": "Pegas Haplotype Network",
    "text": "Pegas Haplotype Network\nCode for haplotype network in pegas\n\n\nCode\n#Haplotype Code to visualize genetic variation between populations\n\nd<-dist.dna(myt_aln) # I think this is the right matrix to use\nh<-pegas::haplotype(myt_aln)\nh<-sort(h,what=\"label\")\nnet<-pegas::haploNet(h)\n#net<-pegas::mst(h)\ni<-utils::stack(setNames(attr(h,\"index\"),rownames(h)))\ni<-i[order(i$values),]\nind.hap<-table(hap=i$ind, pop=loc)\n\nghost.stories<- c(\"darkslategrey\",\"darkslateblue\", \"blue4\", \"royalblue4\", \"deepskyblue\", \"royalblue1\", \"skyblue4\",\"mediumseagreen\",\"darkslateblue\",\"firebrick\",\"coral\",\"darkorange3\",\"darkorange\",\"gold2\",\"gold\",\"yellow1\",\"moccasin\",\"lightskyblue1\",\"lightcyan1\")\n\nlajolla <- sequential_hcl(23, palette = \"Lajolla\")\n\n\nind.hap <- ind.hap[,c(11,6,1,13,3,8,16,18,2,5,17,10,15,4,19,12,7,14,9)]\nind.hap\n\n\n           pop\nhap         Kayak Island El Zeppelin Bamfield Playa Encantada Cape Arago\n  C                    0           0        0               0          0\n  CI                   0           0        0               0          0\n  CII                  0           0        0               0          0\n  CIII                 0           0        0               0          0\n  CIV                  0           0        0               0          0\n  CIX                  0           0        0               0          0\n  CL                   0           1        0               0          0\n  CLI                  0           1        0               0          0\n  CLII                 0           1        0               0          0\n  CLIII                0           0        0               0          0\n  CLIV                 0           0        0               0          0\n  CLIX                 0           0        0               0          0\n  CLV                  0           0        0               0          0\n  CLVI                 0           0        0               0          0\n  CLVII                0           0        0               0          0\n  CLVIII               0           0        0               0          0\n  CLX                  0           0        0               0          0\n  CLXI                 0           0        0               0          0\n  CLXII                0           0        0               0          0\n  CLXIII               0           0        0               0          0\n  CLXIV                0           0        0               0          0\n  CLXIX                0           0        0               0          0\n  CLXV                 0           0        0               0          0\n  CLXVI                0           0        0               0          0\n  CLXVII               0           0        0               0          0\n  CLXVIII              0           0        0               0          0\n  CLXX                 0           0        0               0          0\n  CLXXI                0           0        0               0          0\n  CLXXII               0           0        0               0          0\n  CLXXIII              0           0        0               0          0\n  CLXXIV               0           0        0               0          0\n  CLXXIX               0           0        0               0          0\n  CLXXV                0           0        0               0          0\n  CLXXVI               0           0        0               0          0\n  CLXXVII              0           0        0               0          0\n  CLXXVIII             0           0        0               0          0\n  CLXXX                0           0        0               0          0\n  CLXXXI               0           0        0               0          0\n  CLXXXII              0           0        0               0          0\n  CLXXXIII             0           0        0               0          0\n  CLXXXIV              0           0        0               0          0\n  CLXXXIX              0           0        0               0          0\n  CLXXXV               0           0        0               0          0\n  CLXXXVI              0           0        0               0          0\n  CLXXXVII             0           0        0               0          0\n  CLXXXVIII            0           0        0               0          0\n  CV                   0           0        0               0          0\n  CVI                  0           0        0               0          0\n  CVII                 0           0        0               0          0\n  CVIII                0           0        0               0          0\n  CX                   0           0        0               0          0\n  CXC                  0           0        0               0          0\n  CXCI                 0           0        0               0          0\n  CXCII                0           0        0               0          0\n  CXCIII               0           0        0               0          0\n  CXI                  0           0        0               0          0\n  CXII                 0           0        0               0          0\n  CXIII                0           1        0               0          0\n  CXIV                 0           0        0               0          0\n  CXIX                 0           0        0               0          0\n  CXL                  0           0        0               1          0\n  CXLI                 0           0        0               1          0\n  CXLII                0           0        0               1          0\n  CXLIII               0           0        0               1          0\n  CXLIV                0           0        0               1          0\n  CXLIX                0           1        0               0          0\n  CXLV                 0           0        0               1          0\n  CXLVI                0           0        0               1          0\n  CXLVII               0           1        0               0          0\n  CXLVIII              0           1        0               0          0\n  CXV                  0           0        0               0          0\n  CXVI                 0           0        0               0          0\n  CXVII                0           0        0               0          0\n  CXVIII               0           0        0               0          0\n  CXX                  0           0        0               0          0\n  CXXI                 0           0        0               0          0\n  CXXII                0           0        0               0          0\n  CXXIII               0           0        0               0          0\n  CXXIV                0           0        0               0          0\n  CXXIX                0           0        0               0          0\n  CXXV                 0           0        0               0          0\n  CXXVI                0           0        0               0          0\n  CXXVII               0           0        0               0          0\n  CXXVIII              0           0        0               0          0\n  CXXX                 0           0        0               0          0\n  CXXXI                0           0        0               0          0\n  CXXXII               0           0        0               0          0\n  CXXXIII              0           0        0               0          0\n  CXXXIV               0           0        0               0          0\n  CXXXIX               0           0        0               1          0\n  CXXXV                0           0        0               1          0\n  CXXXVI               0           0        0               1          0\n  CXXXVII              0           0        0               1          0\n  CXXXVIII             0           0        0               1          0\n  I                    9          10        4               4          2\n  II                   1           0        0               0          0\n  III                  3           3        5               5          3\n  IV                   1           0        0               0          0\n  IX                   1           0        0               0          0\n  L                    0           0        0               0          1\n  LI                   0           0        0               1          1\n  LII                  0           0        0               0          1\n  LIII                 0           0        0               0          1\n  LIV                  0           0        0               0          1\n  LIX                  0           0        0               0          0\n  LV                   0           0        0               0          1\n  LVI                  0           0        0               0          1\n  LVII                 0           0        0               0          1\n  LVIII                0           0        0               0          1\n  LX                   0           0        0               1          0\n  LXI                  0           0        0               1          0\n  LXII                 0           0        0               0          0\n  LXIII                0           0        0               1          0\n  LXIV                 0           0        0               0          0\n  LXIX                 0           0        0               0          0\n  LXV                  0           0        0               0          0\n  LXVI                 0           0        0               0          0\n  LXVII                0           0        0               0          0\n  LXVIII               0           0        0               0          0\n  LXX                  0           0        0               0          0\n  LXXI                 0           0        0               0          0\n  LXXII                0           0        0               0          0\n  LXXIII               0           0        0               0          0\n  LXXIV                0           0        0               0          0\n  LXXIX                0           0        0               0          0\n  LXXV                 0           0        0               0          0\n  LXXVI                0           0        0               0          0\n  LXXVII               0           0        0               0          0\n  LXXVIII              0           0        0               0          0\n  LXXX                 0           0        0               0          0\n  LXXXI                0           1        0               0          0\n  LXXXII               0           0        0               0          0\n  LXXXIII              0           0        0               0          0\n  LXXXIV               0           0        0               0          0\n  LXXXIX               0           0        0               0          0\n  LXXXV                0           0        0               0          0\n  LXXXVI               0           0        0               0          0\n  LXXXVII              0           0        0               0          0\n  LXXXVIII             0           0        0               0          0\n  V                    1           0        0               0          0\n  VI                   1           0        1               0          0\n  VII                  1           0        0               0          0\n  VIII                 1           1        0               1          0\n  X                    1           1        0               0          0\n  XC                   0           0        0               0          0\n  XCI                  0           0        0               0          0\n  XCII                 0           0        0               0          0\n  XCIII                0           0        0               0          0\n  XCIV                 0           0        0               0          0\n  XCIX                 0           0        0               0          0\n  XCV                  0           0        0               0          0\n  XCVI                 0           0        0               0          0\n  XCVII                0           0        0               0          0\n  XCVIII               0           0        0               0          0\n  XI                   0           0        0               0          0\n  XII                  0           0        0               0          0\n  XIII                 0           0        0               0          0\n  XIV                  0           0        0               0          0\n  XIX                  0           0        0               0          0\n  XL                   0           0        0               0          0\n  XLI                  0           0        0               0          0\n  XLII                 0           0        0               0          0\n  XLIII                0           0        0               0          0\n  XLIV                 0           0        0               0          0\n  XLIX                 0           0        0               0          1\n  XLV                  0           0        0               0          0\n  XLVI                 0           0        0               0          0\n  XLVII                0           0        0               0          0\n  XLVIII               0           0        0               0          1\n  XV                   0           0        0               0          0\n  XVI                  0           0        0               0          0\n  XVII                 0           0        0               0          0\n  XVIII                0           0        0               0          0\n  XX                   0           0        0               0          0\n  XXI                  0           0        0               0          0\n  XXII                 0           0        0               0          0\n  XXIII                0           0        0               0          0\n  XXIV                 0           0        1               0          0\n  XXIX                 0           0        1               0          0\n  XXV                  0           0        1               0          0\n  XXVI                 0           0        1               0          0\n  XXVII                0           0        1               0          0\n  XXVIII               0           0        1               2          0\n  XXX                  0           0        1               0          0\n  XXXI                 0           0        1               0          0\n  XXXII                0           0        1               0          0\n  XXXIII               0           0        1               0          0\n  XXXIV                0           2        1               0          3\n  XXXIX                0           0        0               0          0\n  XXXV                 0           0        1               0          1\n  XXXVI                0           0        1               0          0\n  XXXVII               0           0        0               0          0\n  XXXVIII              0           0        0               0          0\n           pop\nhap         Enderts Beach Punta Clara Punta San Carlos Bodega Head\n  C                     0           0                0           0\n  CI                    0           0                0           0\n  CII                   0           0                0           0\n  CIII                  0           0                0           0\n  CIV                   0           0                0           0\n  CIX                   0           0                0           0\n  CL                    0           0                0           0\n  CLI                   0           0                0           0\n  CLII                  0           0                0           0\n  CLIII                 0           1                0           0\n  CLIV                  0           1                0           0\n  CLIX                  0           1                0           0\n  CLV                   0           1                0           0\n  CLVI                  0           1                0           0\n  CLVII                 0           1                0           0\n  CLVIII                0           1                0           0\n  CLX                   0           1                0           0\n  CLXI                  0           0                0           0\n  CLXII                 0           0                0           0\n  CLXIII                0           0                0           0\n  CLXIV                 0           0                0           0\n  CLXIX                 0           0                1           0\n  CLXV                  0           0                0           0\n  CLXVI                 0           0                1           0\n  CLXVII                0           0                1           0\n  CLXVIII               0           0                1           0\n  CLXX                  0           0                1           0\n  CLXXI                 0           0                1           0\n  CLXXII                0           0                1           0\n  CLXXIII               0           0                1           0\n  CLXXIV                0           0                1           0\n  CLXXIX                0           0                0           0\n  CLXXV                 0           0                1           0\n  CLXXVI                0           0                0           0\n  CLXXVII               0           0                0           0\n  CLXXVIII              0           0                0           0\n  CLXXX                 0           0                0           0\n  CLXXXI                0           0                0           0\n  CLXXXII               0           0                0           0\n  CLXXXIII              0           0                0           0\n  CLXXXIV               0           0                0           0\n  CLXXXIX               0           0                0           0\n  CLXXXV                0           0                0           0\n  CLXXXVI               0           0                0           0\n  CLXXXVII              0           0                0           0\n  CLXXXVIII             0           0                0           0\n  CV                    0           0                0           0\n  CVI                   0           0                0           0\n  CVII                  0           0                0           0\n  CVIII                 0           0                0           0\n  CX                    0           0                0           0\n  CXC                   0           0                0           0\n  CXCI                  0           0                0           0\n  CXCII                 0           0                0           0\n  CXCIII                0           0                0           0\n  CXI                   0           0                0           0\n  CXII                  0           0                0           0\n  CXIII                 0           0                0           0\n  CXIV                  0           0                0           0\n  CXIX                  0           0                0           0\n  CXL                   0           0                0           0\n  CXLI                  0           0                0           0\n  CXLII                 0           0                0           0\n  CXLIII                0           0                0           0\n  CXLIV                 0           0                0           0\n  CXLIX                 0           0                0           0\n  CXLV                  0           0                0           0\n  CXLVI                 0           0                0           0\n  CXLVII                0           0                0           0\n  CXLVIII               0           0                0           0\n  CXV                   0           0                0           0\n  CXVI                  0           0                0           0\n  CXVII                 0           0                0           0\n  CXVIII                0           0                0           0\n  CXX                   0           0                0           0\n  CXXI                  0           0                0           0\n  CXXII                 0           0                0           0\n  CXXIII                0           0                1           0\n  CXXIV                 0           0                0           0\n  CXXIX                 0           0                0           0\n  CXXV                  0           0                0           0\n  CXXVI                 0           0                0           0\n  CXXVII                0           0                0           0\n  CXXVIII               0           0                0           0\n  CXXX                  0           0                0           0\n  CXXXI                 0           0                0           0\n  CXXXII                0           0                0           0\n  CXXXIII               0           0                0           0\n  CXXXIV                0           0                0           0\n  CXXXIX                0           0                0           0\n  CXXXV                 0           0                0           0\n  CXXXVI                0           0                0           0\n  CXXXVII               0           0                0           0\n  CXXXVIII              0           0                0           0\n  I                     3           9                7           0\n  II                    0           0                0           0\n  III                   2           6                2           1\n  IV                    0           0                1           0\n  IX                    0           1                0           0\n  L                     0           1                0           0\n  LI                    0           2                0           0\n  LII                   0           0                0           0\n  LIII                  0           0                0           0\n  LIV                   0           1                0           0\n  LIX                   1           0                0           0\n  LV                    0           0                0           0\n  LVI                   0           0                0           0\n  LVII                  0           0                0           0\n  LVIII                 0           0                0           0\n  LX                    1           0                0           0\n  LXI                   2           0                0           0\n  LXII                  1           0                0           0\n  LXIII                 2           1                0           1\n  LXIV                  1           0                0           0\n  LXIX                  0           0                0           0\n  LXV                   1           0                0           0\n  LXVI                  1           0                0           0\n  LXVII                 1           0                0           0\n  LXVIII                1           0                0           0\n  LXX                   0           0                0           0\n  LXXI                  0           0                0           0\n  LXXII                 0           0                2           0\n  LXXIII                0           0                0           0\n  LXXIV                 0           0                0           0\n  LXXIX                 0           0                0           0\n  LXXV                  0           0                0           0\n  LXXVI                 0           0                0           0\n  LXXVII                0           0                0           0\n  LXXVIII               0           0                0           0\n  LXXX                  0           0                0           0\n  LXXXI                 0           0                1           0\n  LXXXII                0           0                0           0\n  LXXXIII               0           0                0           0\n  LXXXIV                0           0                0           0\n  LXXXIX                0           0                0           1\n  LXXXV                 0           1                0           1\n  LXXXVI                0           0                0           1\n  LXXXVII               0           0                0           1\n  LXXXVIII              0           0                0           1\n  V                     0           0                0           0\n  VI                    0           0                0           0\n  VII                   0           0                0           0\n  VIII                  1           1                1           0\n  X                     0           0                1           0\n  XC                    0           0                0           1\n  XCI                   0           0                0           1\n  XCII                  0           0                0           1\n  XCIII                 0           0                0           1\n  XCIV                  0           0                0           0\n  XCIX                  0           0                0           0\n  XCV                   0           0                0           0\n  XCVI                  0           0                0           0\n  XCVII                 0           0                0           0\n  XCVIII                0           0                0           0\n  XI                    0           0                0           0\n  XII                   0           0                0           0\n  XIII                  0           0                0           0\n  XIV                   0           0                0           0\n  XIX                   0           1                1           0\n  XL                    0           0                0           0\n  XLI                   0           0                0           0\n  XLII                  0           2                0           0\n  XLIII                 0           0                0           0\n  XLIV                  0           0                0           0\n  XLIX                  0           0                0           0\n  XLV                   0           0                0           0\n  XLVI                  0           0                0           0\n  XLVII                 0           0                0           0\n  XLVIII                0           0                0           0\n  XV                    0           0                0           0\n  XVI                   0           0                0           0\n  XVII                  0           0                0           0\n  XVIII                 0           0                0           0\n  XX                    0           0                0           0\n  XXI                   0           0                0           0\n  XXII                  0           0                0           0\n  XXIII                 0           0                1           0\n  XXIV                  0           0                0           0\n  XXIX                  0           0                0           0\n  XXV                   0           0                0           0\n  XXVI                  0           0                0           0\n  XXVII                 0           0                0           0\n  XXVIII                0           0                0           0\n  XXX                   0           0                0           0\n  XXXI                  0           0                0           0\n  XXXII                 0           0                0           0\n  XXXIII                0           0                0           0\n  XXXIV                 1           2                0           0\n  XXXIX                 0           0                0           0\n  XXXV                  1           0                0           0\n  XXXVI                 0           0                0           0\n  XXXVII                0           0                0           0\n  XXXVIII               0           0                0           0\n           pop\nhap         Davenport Landing Punta Lobos Hazard Reef Punta Baja Carpinteria\n  C                         0           0           0          0           0\n  CI                        0           0           0          0           0\n  CII                       0           0           0          0           0\n  CIII                      0           1           0          0           0\n  CIV                       0           0           0          0           0\n  CIX                       0           0           1          0           1\n  CL                        0           0           0          0           0\n  CLI                       0           0           0          0           0\n  CLII                      0           0           0          0           0\n  CLIII                     0           0           0          0           0\n  CLIV                      0           0           0          0           0\n  CLIX                      0           0           0          0           0\n  CLV                       0           0           0          0           0\n  CLVI                      0           0           0          0           0\n  CLVII                     0           0           0          0           0\n  CLVIII                    0           0           0          0           0\n  CLX                       0           0           0          0           0\n  CLXI                      0           0           0          1           0\n  CLXII                     0           0           0          1           0\n  CLXIII                    0           0           0          1           0\n  CLXIV                     0           0           0          1           0\n  CLXIX                     0           0           0          0           0\n  CLXV                      0           0           0          1           0\n  CLXVI                     0           0           0          0           0\n  CLXVII                    0           0           0          0           0\n  CLXVIII                   0           0           0          0           0\n  CLXX                      0           0           0          0           0\n  CLXXI                     0           0           0          0           0\n  CLXXII                    0           0           0          0           0\n  CLXXIII                   0           0           0          0           0\n  CLXXIV                    0           0           0          0           0\n  CLXXIX                    0           0           0          0           0\n  CLXXV                     0           0           0          0           0\n  CLXXVI                    0           0           0          0           0\n  CLXXVII                   0           0           0          0           0\n  CLXXVIII                  0           0           0          0           0\n  CLXXX                     0           0           0          0           0\n  CLXXXI                    0           0           0          0           0\n  CLXXXII                   0           0           0          0           0\n  CLXXXIII                  0           0           0          0           0\n  CLXXXIV                   0           0           0          0           0\n  CLXXXIX                   0           1           0          0           0\n  CLXXXV                    0           1           0          0           0\n  CLXXXVI                   0           1           0          0           0\n  CLXXXVII                  0           1           0          0           0\n  CLXXXVIII                 0           1           0          0           0\n  CV                        0           0           0          0           0\n  CVI                       0           0           0          0           0\n  CVII                      0           0           0          0           0\n  CVIII                     0           0           1          0           0\n  CX                        0           0           1          0           0\n  CXC                       0           1           0          0           0\n  CXCI                      0           1           0          0           0\n  CXCII                     0           1           0          0           0\n  CXCIII                    0           1           0          0           0\n  CXI                       0           0           1          0           0\n  CXII                      0           0           1          0           0\n  CXIII                     0           0           1          1           0\n  CXIV                      0           0           1          0           0\n  CXIX                      0           0           0          0           0\n  CXL                       0           0           0          0           0\n  CXLI                      0           0           0          0           0\n  CXLII                     0           0           0          0           0\n  CXLIII                    0           0           0          0           0\n  CXLIV                     0           0           0          0           0\n  CXLIX                     0           0           0          0           0\n  CXLV                      0           0           0          0           0\n  CXLVI                     0           0           0          1           0\n  CXLVII                    0           0           0          0           0\n  CXLVIII                   0           0           0          0           0\n  CXV                       0           0           1          0           0\n  CXVI                      0           0           1          0           0\n  CXVII                     0           0           0          0           0\n  CXVIII                    0           0           0          0           1\n  CXX                       0           0           0          0           0\n  CXXI                      0           0           0          0           0\n  CXXII                     0           0           0          0           0\n  CXXIII                    0           0           0          0           1\n  CXXIV                     0           0           0          0           1\n  CXXIX                     0           0           0          0           0\n  CXXV                      0           0           0          1           2\n  CXXVI                     0           0           0          0           1\n  CXXVII                    0           0           0          0           1\n  CXXVIII                   0           1           0          0           0\n  CXXX                      0           0           0          0           0\n  CXXXI                     0           0           0          0           0\n  CXXXII                    0           0           0          0           0\n  CXXXIII                   0           0           0          0           0\n  CXXXIV                    0           0           0          0           0\n  CXXXIX                    0           0           0          0           0\n  CXXXV                     0           0           0          0           0\n  CXXXVI                    0           0           0          0           0\n  CXXXVII                   0           0           0          0           0\n  CXXXVIII                  0           0           0          0           0\n  I                         1           8          11         10           4\n  II                        0           0           0          0           0\n  III                       3           6           2          2           1\n  IV                        0           0           0          0           0\n  IX                        0           1           0          0           1\n  L                         0           0           0          0           0\n  LI                        0           0           0          0           0\n  LII                       0           0           0          0           0\n  LIII                      0           0           0          0           0\n  LIV                       0           0           0          0           1\n  LIX                       0           0           0          0           0\n  LV                        0           0           0          0           0\n  LVI                       0           0           0          0           0\n  LVII                      0           0           0          0           0\n  LVIII                     0           0           0          0           0\n  LX                        1           0           0          0           0\n  LXI                       1           0           0          0           0\n  LXII                      0           0           0          0           0\n  LXIII                     0           0           0          0           0\n  LXIV                      0           0           0          0           0\n  LXIX                      0           0           0          0           0\n  LXV                       0           0           0          0           0\n  LXVI                      0           0           0          0           0\n  LXVII                     0           0           0          0           0\n  LXVIII                    0           0           0          0           0\n  LXX                       0           0           0          0           0\n  LXXI                      0           0           0          0           0\n  LXXII                     1           1           0          1           1\n  LXXIII                    0           0           0          0           0\n  LXXIV                     0           0           0          0           0\n  LXXIX                     0           0           0          0           0\n  LXXV                      0           0           0          0           0\n  LXXVI                     0           0           0          0           0\n  LXXVII                    0           0           0          0           0\n  LXXVIII                   0           0           0          0           0\n  LXXX                      0           0           0          0           0\n  LXXXI                     0           1           0          0           1\n  LXXXII                    0           0           0          0           0\n  LXXXIII                   0           0           0          0           0\n  LXXXIV                    0           0           0          0           0\n  LXXXIX                    0           0           0          0           0\n  LXXXV                     0           0           0          0           0\n  LXXXVI                    0           0           0          0           0\n  LXXXVII                   0           0           0          0           0\n  LXXXVIII                  0           0           0          0           0\n  V                         0           0           0          0           0\n  VI                        0           0           0          0           0\n  VII                       2           0           0          0           0\n  VIII                      0           0           0          0           0\n  X                         1           0           0          1           0\n  XC                        0           0           0          0           0\n  XCI                       0           0           0          0           0\n  XCII                      0           0           0          0           0\n  XCIII                     0           0           0          0           0\n  XCIV                      1           0           0          0           0\n  XCIX                      0           0           0          0           0\n  XCV                       1           0           0          0           0\n  XCVI                      1           0           0          0           0\n  XCVII                     1           0           0          0           0\n  XCVIII                    1           0           0          0           0\n  XI                        0           0           0          0           0\n  XII                       0           0           0          0           0\n  XIII                      0           0           0          0           0\n  XIV                       0           0           0          0           0\n  XIX                       0           0           0          0           0\n  XL                        0           0           0          0           0\n  XLI                       0           0           0          0           0\n  XLII                      0           0           0          0           0\n  XLIII                     0           0           0          0           0\n  XLIV                      0           0           0          0           0\n  XLIX                      1           1           1          0           0\n  XLV                       0           0           0          0           0\n  XLVI                      0           0           0          0           0\n  XLVII                     0           0           0          0           0\n  XLVIII                    0           0           0          0           0\n  XV                        0           0           0          0           0\n  XVI                       0           0           0          0           0\n  XVII                      0           0           0          0           0\n  XVIII                     0           0           0          0           0\n  XX                        0           0           0          0           0\n  XXI                       0           0           0          0           0\n  XXII                      0           0           0          0           0\n  XXIII                     0           0           0          0           1\n  XXIV                      0           0           0          0           0\n  XXIX                      0           0           0          0           0\n  XXV                       0           0           0          0           0\n  XXVI                      0           0           0          0           0\n  XXVII                     0           0           0          0           0\n  XXVIII                    1           0           0          0           0\n  XXX                       0           0           0          0           0\n  XXXI                      0           0           0          0           1\n  XXXII                     0           0           0          0           0\n  XXXIII                    0           0           0          0           0\n  XXXIV                     0           0           0          1           0\n  XXXIX                     0           0           0          0           0\n  XXXV                      0           0           0          2           0\n  XXXVI                     0           0           0          0           0\n  XXXVII                    0           0           0          0           0\n  XXXVIII                   0           0           0          0           0\n           pop\nhap         Refugio Beach La Jolla Elfin Cove Port Renfrew Faro San Jose\n  C                     0        0          0            0             0\n  CI                    0        0          0            0             0\n  CII                   0        0          0            0             0\n  CIII                  0        0          0            0             0\n  CIV                   0        0          0            0             0\n  CIX                   0        0          0            0             0\n  CL                    0        0          0            0             0\n  CLI                   0        0          0            0             0\n  CLII                  0        0          0            0             0\n  CLIII                 0        0          0            0             0\n  CLIV                  0        0          0            0             0\n  CLIX                  0        0          0            0             0\n  CLV                   0        0          0            0             0\n  CLVI                  0        0          0            0             0\n  CLVII                 0        0          0            0             0\n  CLVIII                0        0          0            0             0\n  CLX                   0        0          0            0             0\n  CLXI                  0        0          0            0             0\n  CLXII                 0        0          0            0             0\n  CLXIII                0        0          0            0             0\n  CLXIV                 0        0          0            0             0\n  CLXIX                 0        0          0            0             0\n  CLXV                  0        0          0            0             0\n  CLXVI                 0        0          0            0             0\n  CLXVII                0        0          0            0             0\n  CLXVIII               0        0          0            0             0\n  CLXX                  0        0          0            0             0\n  CLXXI                 0        0          0            0             0\n  CLXXII                0        0          0            0             0\n  CLXXIII               0        0          0            0             0\n  CLXXIV                0        0          0            0             0\n  CLXXIX                0        0          0            0             1\n  CLXXV                 0        0          0            0             0\n  CLXXVI                0        0          0            0             1\n  CLXXVII               0        0          0            0             1\n  CLXXVIII              0        0          0            0             1\n  CLXXX                 0        0          0            0             1\n  CLXXXI                0        0          0            0             1\n  CLXXXII               0        0          0            0             1\n  CLXXXIII              0        0          0            0             1\n  CLXXXIV               0        0          0            0             2\n  CLXXXIX               0        0          0            0             0\n  CLXXXV                0        0          0            0             0\n  CLXXXVI               0        0          0            0             0\n  CLXXXVII              0        0          0            0             0\n  CLXXXVIII             0        0          0            0             0\n  CV                    0        0          0            0             0\n  CVI                   0        0          0            0             0\n  CVII                  0        0          0            0             0\n  CVIII                 0        0          0            0             0\n  CX                    0        0          0            0             0\n  CXC                   0        0          0            0             0\n  CXCI                  0        0          0            0             0\n  CXCII                 0        0          0            0             0\n  CXCIII                0        0          0            0             0\n  CXI                   0        0          0            0             0\n  CXII                  0        0          0            0             0\n  CXIII                 0        0          0            0             1\n  CXIV                  0        0          0            0             0\n  CXIX                  1        0          0            0             0\n  CXL                   0        0          0            0             0\n  CXLI                  0        0          0            0             0\n  CXLII                 0        0          0            0             0\n  CXLIII                0        0          0            0             0\n  CXLIV                 0        0          0            0             0\n  CXLIX                 0        0          0            0             0\n  CXLV                  0        0          0            0             1\n  CXLVI                 0        0          0            0             0\n  CXLVII                0        0          0            0             0\n  CXLVIII               0        0          0            0             0\n  CXV                   0        0          0            0             0\n  CXVI                  0        0          0            0             0\n  CXVII                 1        0          0            0             0\n  CXVIII                1        0          0            0             0\n  CXX                   1        0          0            0             0\n  CXXI                  2        0          0            0             0\n  CXXII                 1        0          0            0             0\n  CXXIII                0        0          0            0             0\n  CXXIV                 0        0          0            0             0\n  CXXIX                 0        0          0            0             0\n  CXXV                  0        0          0            0             0\n  CXXVI                 0        0          0            0             0\n  CXXVII                0        0          0            0             0\n  CXXVIII               0        0          0            0             0\n  CXXX                  0        0          0            0             0\n  CXXXI                 0        1          0            0             0\n  CXXXII                0        2          0            0             0\n  CXXXIII               0        1          0            0             0\n  CXXXIV                0        1          0            0             0\n  CXXXIX                0        0          0            0             0\n  CXXXV                 0        0          0            0             0\n  CXXXVI                0        0          0            0             0\n  CXXXVII               0        0          0            0             0\n  CXXXVIII              0        0          0            0             0\n  I                     4        1          3            1             3\n  II                    0        0          0            0             0\n  III                   0        0          1            1             4\n  IV                    0        0          0            0             0\n  IX                    0        0          2            0             0\n  L                     0        0          0            0             0\n  LI                    0        0          0            0             0\n  LII                   0        0          0            0             0\n  LIII                  0        0          0            0             0\n  LIV                   0        0          0            0             0\n  LIX                   0        0          0            0             0\n  LV                    0        0          0            0             0\n  LVI                   0        0          0            0             0\n  LVII                  0        0          0            0             0\n  LVIII                 0        0          0            0             0\n  LX                    0        0          0            0             0\n  LXI                   0        0          0            0             0\n  LXII                  0        0          0            0             0\n  LXIII                 0        0          0            0             0\n  LXIV                  0        0          0            0             0\n  LXIX                  0        0          0            0             0\n  LXV                   0        0          0            0             0\n  LXVI                  0        0          0            0             0\n  LXVII                 0        0          0            0             1\n  LXVIII                0        0          0            0             0\n  LXX                   0        0          0            0             0\n  LXXI                  0        0          0            0             0\n  LXXII                 0        0          0            0             0\n  LXXIII                1        1          0            0             0\n  LXXIV                 0        0          0            0             0\n  LXXIX                 0        0          0            0             0\n  LXXV                  0        0          0            0             0\n  LXXVI                 0        0          0            0             0\n  LXXVII                0        0          0            0             0\n  LXXVIII               0        0          0            0             0\n  LXXX                  0        0          0            0             0\n  LXXXI                 0        0          0            0             2\n  LXXXII                0        0          0            0             0\n  LXXXIII               0        0          0            0             0\n  LXXXIV                0        0          0            0             0\n  LXXXIX                0        0          0            0             0\n  LXXXV                 0        0          0            0             0\n  LXXXVI                0        0          0            0             0\n  LXXXVII               0        0          0            0             0\n  LXXXVIII              0        0          0            0             0\n  V                     0        0          0            0             0\n  VI                    0        0          0            0             0\n  VII                   1        0          0            0             0\n  VIII                  0        1          0            1             0\n  X                     1        0          0            0             0\n  XC                    0        0          0            0             0\n  XCI                   0        0          0            0             0\n  XCII                  0        0          0            0             0\n  XCIII                 0        0          0            0             0\n  XCIV                  0        0          0            0             0\n  XCIX                  0        0          0            0             0\n  XCV                   0        0          0            0             1\n  XCVI                  0        0          0            0             0\n  XCVII                 0        0          0            0             0\n  XCVIII                0        0          0            0             0\n  XI                    0        0          1            0             0\n  XII                   0        0          1            0             0\n  XIII                  0        0          1            0             0\n  XIV                   0        0          1            0             0\n  XIX                   0        0          1            0             1\n  XL                    0        0          0            1             0\n  XLI                   0        0          0            1             0\n  XLII                  0        0          0            1             0\n  XLIII                 0        0          0            1             0\n  XLIV                  0        0          0            1             0\n  XLIX                  0        0          0            0             0\n  XLV                   0        0          0            1             0\n  XLVI                  0        0          0            1             0\n  XLVII                 0        0          0            1             0\n  XLVIII                0        0          0            0             0\n  XV                    0        0          1            0             0\n  XVI                   0        0          1            0             0\n  XVII                  0        0          1            0             0\n  XVIII                 0        0          1            0             0\n  XX                    0        0          1            0             0\n  XXI                   0        0          1            0             1\n  XXII                  0        0          1            0             0\n  XXIII                 0        0          1            0             0\n  XXIV                  0        0          0            0             0\n  XXIX                  0        0          0            0             0\n  XXV                   0        0          0            0             0\n  XXVI                  0        0          0            0             0\n  XXVII                 0        0          0            0             0\n  XXVIII                0        0          0            0             0\n  XXX                   1        0          0            0             0\n  XXXI                  0        0          0            0             0\n  XXXII                 0        0          0            0             0\n  XXXIII                0        0          0            0             0\n  XXXIV                 0        0          0            1             1\n  XXXIX                 0        0          0            1             0\n  XXXV                  1        0          0            0             0\n  XXXVI                 0        0          0            0             0\n  XXXVII                0        0          0            1             0\n  XXXVIII               0        0          0            1             0\n\n\nCode\n#pdf(file = \"modified_haplotype.pdf\", width = 8.5, height = 11)\n#plot(net,size=(attr(net,\"freq\")/5),scale.ratio=2.25,pie=ind.hap,legend=F,labels=F,threshold=0,show.mutation=2,bg=lajolla,pch=19,ncol=1,cex=0.85)\n#legend(\"topleft\",colnames(ind.hap),col=ghost.stories,pch=19,ncol=1,cex=0.85)\n\n#dev.off()"
  },
  {
    "objectID": "Mcali_analysis.html#popart",
    "href": "Mcali_analysis.html#popart",
    "title": "Mytilus californianus full range population genetic analysis",
    "section": "PopArt",
    "text": "PopArt\nCode for preparing for PopArt.\n\n\nCode\nhapseqs<-h[] # pull out the DNAbin object from the haplotype object #write this to nexus format\nwrite.nexus.data(hapseqs,\n                 file=\"popart/mcali_haplotypes.nex\",\n                  interleaved=F) #write both haplotype tables to csv\nwrite.csv(ind.hap, file=\"popart/mcali_table.csv\",\n                  quote=F)\n\n#write the flattened metadata too.\nwrite.csv(events, file=\"mcali_event_metadata.csv\",\n              quote=F)"
  },
  {
    "objectID": "Mcali_analysis.html#preparing-the-data-for-migrate",
    "href": "Mcali_analysis.html#preparing-the-data-for-migrate",
    "title": "Mytilus californianus full range population genetic analysis",
    "section": "Preparing the data for migrate",
    "text": "Preparing the data for migrate\n\n\nCode\n# convert to Phangorn\nmyt_phy <- phyDat(myt_aln)\n# create a Jukes-Cantor distance matrix from all sequences\ndm <- dist.ml(myt_phy, model =\"JC69\")\n#create a neighbor-joining tree from the distance matrix\ntree <- NJ(dm)\n\nmcali_modeltest<-modelTest(myt_phy, tree,G=T, I=F)\n\n\n[1] \"JC\"\n[1] \"JC+G\"\n[1] \"F81\"\n[1] \"F81+G\"\n[1] \"K80\"\n[1] \"K80+G\"\n[1] \"HKY\"\n[1] \"HKY+G\"\n[1] \"TrNe\"\n[1] \"TrNe+G\"\n[1] \"TrN\"\n[1] \"TrN+G\"\n[1] \"TPM1\"\n[1] \"TPM1+G\"\n[1] \"K81\"\n[1] \"K81+G\"\n[1] \"TPM1u\"\n[1] \"TPM1u+G\"\n[1] \"TPM2\"\n[1] \"TPM2+G\"\n[1] \"TPM2u\"\n[1] \"TPM2u+G\"\n[1] \"TPM3\"\n[1] \"TPM3+G\"\n[1] \"TPM3u\"\n[1] \"TPM3u+G\"\n[1] \"TIM1e\"\n[1] \"TIM1e+G\"\n[1] \"TIM1\"\n[1] \"TIM1+G\"\n[1] \"TIM2e\"\n[1] \"TIM2e+G\"\n[1] \"TIM2\"\n[1] \"TIM2+G\"\n[1] \"TIM3e\"\n[1] \"TIM3e+G\"\n[1] \"TIM3\"\n[1] \"TIM3+G\"\n[1] \"TVMe\"\n[1] \"TVMe+G\"\n[1] \"TVM\"\n[1] \"TVM+G\"\n[1] \"SYM\"\n[1] \"SYM+G\"\n[1] \"GTR\"\n[1] \"GTR+G\"\n\n\nCode\nmcali_modeltest<-mcali_modeltest[order(mcali_modeltest$BIC),]\n\nhead(mcali_modeltest)\n\n\n\n\n  \n\n\n\nSome funky code to get the gamma shape parameter, and discrete rates\n\n\nCode\n#this is one way - reach into the environment \nenv <- attr(mcali_modeltest, \"env\")\nTIM1 <- get(\"TIM1+G(4)\", env)\n#eval(HKY, env=env)\nshape <- 0.26375833217876\n\n# here's the other way - as.pml()\nmcali_pml <- as.pml(mcali_modeltest)\nmcali_pml$g # four rate categories\n\n\n[1] 0.002817133 0.076806583 0.529658802 3.390717482\n\n\nCode\nmcali_pml$w # probabilities of each rate\n\n\n[1] 0.25 0.25 0.25 0.25\n\n\nCode\nplot(density(rgamma(10000,shape=shape)), xlim=c(0,1))\n\n\n\n\n\nCode\nmigrate_rates <- phangorn:::discrete.gamma(shape,4)\n\nplot_gamma_plus_inv(shape =shape)\n\n\n\n\n\nCode\nTiTvRatio(myt_g) #need strataG for this\n\n\n         Ti          Tv Ti.Tv.ratio \n 119.000000   41.000000    2.902439 \n\n\nCode\n# pml(tree = `tree_TIM1+G(4)`, data = data, bf = c(0.288481138885885, \n# 0.160432444597162, 0.209795981107601, 0.341290435409352), Q = c(1, \n# 5.39011701149672, 0.297813690823323, 0.297813690823323, 17.1942098908114, \n# 1), model = \"TIM1\", k = 4, shape = 0.26375833217876)\n\n#according to the docs for pml() bf = base frequencies, Q is the lower triangle of the rate matrix, k = number of intervals in the discrete gamma, shape=shape parameter of gamma distribution\n\nQ = c(1, 5.39103240795265, 0.297798914794784, 0.297798914794784, 17.193305668728, 1)\nmat <- matrix(0, nrow = 4, ncol = 4)\nmat[lower.tri(mat, diag = F)] <- Q\nmat\n\n\n          [,1]       [,2] [,3] [,4]\n[1,] 0.0000000  0.0000000    0    0\n[2,] 1.0000000  0.0000000    0    0\n[3,] 5.3910324  0.2977989    0    0\n[4,] 0.2977989 17.1933057    1    0\n\n\n\n\nCode\n# Format data for migrate\n#write.nexus.data(myt_aln,\"./migrate/mcali_migrate.nex\", interleaved=F,missing=\"N\")"
  }
]