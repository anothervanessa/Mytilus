<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vanessa Garcia, Paulina Perez, Alicia Abadia-Cardoso, Eric Crandall">

<title>Mytilus californianus full range population genetic analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#fst" id="toc-fst" class="nav-link" data-scroll-target="#fst">Fst</a></li>
  <li><a href="#isolation-by-distance" id="toc-isolation-by-distance" class="nav-link" data-scroll-target="#isolation-by-distance">Isolation by Distance</a></li>
  <li><a href="#haplotype-networks" id="toc-haplotype-networks" class="nav-link" data-scroll-target="#haplotype-networks">Haplotype Networks</a>
  <ul>
  <li><a href="#pegas-haplotype-network" id="toc-pegas-haplotype-network" class="nav-link" data-scroll-target="#pegas-haplotype-network">Pegas Haplotype Network</a></li>
  <li><a href="#popart" id="toc-popart" class="nav-link" data-scroll-target="#popart">PopArt</a></li>
  </ul></li>
  <li><a href="#migrate" id="toc-migrate" class="nav-link" data-scroll-target="#migrate">Migrate</a>
  <ul>
  <li><a href="#preparing-the-data-for-migrate" id="toc-preparing-the-data-for-migrate" class="nav-link" data-scroll-target="#preparing-the-data-for-migrate">Preparing the data for migrate</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mytilus californianus full range population genetic analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vanessa Garcia, Paulina Perez, Alicia Abadia-Cardoso, Eric Crandall </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="setup" class="level1">
<h1>Setup</h1>
<p>Load the packages we will need for this analysis. Following <a href="https://quarto.org/docs/publishing/github-pages.html#render-to-docs">these instructions</a> to render this code to a website.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pegas)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adegenet)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rentrez)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Biostrings)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#library(BiocGenerics)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betapart)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strataG)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyclust)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phangorn)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Here we will be conducting a population genetic analysis of the California Mussel (Mejillón de California; <em>Mytilus californianus</em>), a species that inhabits the mid-intertidal zone on open coastlines from Baja California to southern Alaska. We have been fortunate to obtain tissue samples and mitochondrial CO1 sequences from the entire range, from near Sitka in Alaska, to Punta Baja in Baja California. We now want to conduct some basic population genetic analyses on these data, and then set up an analysis in Migrate-n , which Eric has shown to be much more sensitive to metapopulation structure than <span class="math inline">\(F_{ST}\)</span>-based methods.</p>
</section>
<section id="data-import" class="level1">
<h1>Data Import</h1>
<p>The data comprise 501 mtDNA sequences for 480 bp from 23(!) localities, so an average sample size of 20.875 per locality. Pretty good! We will import them here from a FASTA file, and split of the locality names, and convert them into formats for various packages.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read into DNAbin format</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>myt_aln <span class="ot">&lt;-</span> <span class="fu">read.FASTA</span>(<span class="st">"data/mytilus_full_range_230323.fasta"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from a list DNAbin to a matrix DNAbin, as the sequences were already aligned in Geneious</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>myt_aln <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(myt_aln)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get the population names and add spaces to them</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="fu">labels</span>(myt_aln),<span class="at">pattern=</span><span class="st">"([A-Za-z_]+)_</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="at">replacement=</span><span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">gsub</span>(loc, <span class="at">pattern=</span><span class="st">"([a-z])([A-Z])"</span>, <span class="at">replacement=</span> <span class="st">"</span><span class="sc">\\</span><span class="st">1 </span><span class="sc">\\</span><span class="st">2"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create a list of localities</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>locorder <span class="ot">&lt;-</span> <span class="fu">unique</span>(loc)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to gtypes format for StrataG</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>myt_g <span class="ot">&lt;-</span> <span class="fu">sequence2gtypes</span>(myt_aln, <span class="at">strata=</span>loc)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># find and label the unique haplotypes</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>myt_g <span class="ot">&lt;-</span> <span class="fu">labelHaplotypes</span>(myt_g)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># get the Ti:Tv ratio</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">TiTvRatio</span>(myt_g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Ti          Tv Ti.Tv.ratio 
 119.000000   41.000000    2.902439 </code></pre>
</div>
</div>
<p>Read in the metadata - just the sampling event metadata for now.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/Mcalifornianus_GEOME.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Events"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> events <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">decimalLatitude =</span> <span class="fu">as.numeric</span>(decimalLatitude)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">decimalLongitude =</span> <span class="fu">as.numeric</span>(decimalLongitude))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>events2 <span class="ot">&lt;-</span> events[,<span class="fu">c</span>(<span class="st">"locality"</span>,<span class="st">"decimalLatitude"</span>, <span class="st">"decimalLongitude"</span>)] </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(events2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"locality"</span>, <span class="st">"lat"</span>, <span class="st">"lon"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>mc_map <span class="ot">&lt;-</span> <span class="fu">get_map</span>(<span class="at">location =</span> <span class="fu">c</span>(<span class="at">top =</span> <span class="dv">60</span>, <span class="at">bottom =</span> <span class="dv">28</span>, <span class="at">left =</span> <span class="sc">-</span><span class="dv">145</span>, <span class="at">right =</span> <span class="sc">-</span><span class="dv">114</span> ), <span class="at">zoom =</span> <span class="dv">4</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(mc_map) <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> events2, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> events2, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"  "</span>, <span class="fu">as.character</span>(locality), <span class="at">sep=</span><span class="st">""</span>)), </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">60</span>, <span class="at">color =</span> <span class="st">"yellow"</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fst" class="level1">
<h1>Fst</h1>
<p>Calculate pairwise Wright’s <span class="math inline">\(F_{ST}\)</span> and <span class="math inline">\(\Phi_{ST}\)</span>, which is the sequence analog.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">pairwiseTest</span>(myt_g, <span class="at">model =</span> <span class="st">"raw"</span>, <span class="at">nrep=</span><span class="dv">0</span>, <span class="at">quietly =</span> F, <span class="at">max.cores=</span><span class="dv">4</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pairwise_phi <span class="ot">&lt;-</span> <span class="fu">pairwiseMatrix</span>(pairwise, <span class="at">stat =</span> <span class="st">"PHIst"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>pairwise_phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pairwise_phi)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>pairwise_phi[<span class="fu">upper.tri</span>(pairwise_phi)]<span class="ot">&lt;-</span> <span class="fu">t</span>(pairwise_phi)[<span class="fu">upper.tri</span>(pairwise_phi)]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>pairwise_phi <span class="ot">&lt;-</span> pairwise_phi[locorder, locorder]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#pairwise_phi &lt;- pairwise_phi/(1-pairwise_phi)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>pairwise_phi.d <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(pairwise_phi)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>pairwise_fst <span class="ot">&lt;-</span> <span class="fu">pairwiseMatrix</span>(pairwise, <span class="at">stat =</span> <span class="st">"Fst"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>pairwise_fst <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pairwise_fst)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>pairwise_fst[<span class="fu">upper.tri</span>(pairwise_fst)]<span class="ot">&lt;-</span> <span class="fu">t</span>(pairwise_fst)[<span class="fu">upper.tri</span>(pairwise_fst)]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>pairwise_fst <span class="ot">&lt;-</span> pairwise_fst[locorder, locorder]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pairwise_fst &lt;- pairwise_fst/(1-pairwise_fst)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>pairwise_fst.d <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(pairwise_fst)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(pairwise_phi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(pairwise_phi, "results/pairwise_phi_mcali.csv")</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(pairwise_fst, "results/pairwise_fst_mcali.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="isolation-by-distance" class="level1">
<h1>Isolation by Distance</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>events2 <span class="ot">&lt;-</span> events2 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(lat))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> <span class="fu">pointDistance</span>(<span class="at">p1=</span>events2[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)], <span class="at">lonlat=</span>T,<span class="at">allpairs=</span>T)<span class="sc">/</span><span class="dv">1000</span> <span class="co">#measure great circle distance between points in kilometers</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>gdist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(gdist) <span class="co">#convert to distance object</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>phi_mantel <span class="ot">&lt;-</span> <span class="fu">mantel.randtest</span>(pairwise_phi.d,gdist)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>phi_mantel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Monte-Carlo test
Call: mantel.randtest(m1 = pairwise_phi.d, m2 = gdist)

Observation: -0.0432609 

Based on 999 replicates
Simulated p-value: 0.754 
Alternative hypothesis: greater 

     Std.Obs  Expectation     Variance 
-0.316182107 -0.002404396  0.016697361 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pairwise_phi.d_linear <span class="ot">&lt;-</span> pairwise_phi.d <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pairwise_phi.d)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>phi_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(gdist,pairwise_phi.d_linear),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x=</span>gdist,<span class="at">y=</span>pairwise_phi.d)) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">xlab</span>(<span class="st">"Great Circle Distance(km)"</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ylab</span>(<span class="fu">expression</span>(Phi[<span class="st">"ST"</span>]<span class="sc">/</span><span class="dv">1</span><span class="sc">-</span>Phi[<span class="st">"ST"</span>]))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>phi_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"results/phi_plot.pdf"</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height=</span><span class="dv">6</span>,<span class="at">units =</span> <span class="st">"in"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fst_mantel<span class="ot">&lt;-</span><span class="fu">mantel.randtest</span>(pairwise_fst.d,gdist)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>fst_mantel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Monte-Carlo test
Call: mantel.randtest(m1 = pairwise_fst.d, m2 = gdist)

Observation: -0.01732573 

Based on 999 replicates
Simulated p-value: 0.498 
Alternative hypothesis: greater 

     Std.Obs  Expectation     Variance 
-0.168934244  0.003113135  0.014637883 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pairwise_fst.d_linear <span class="ot">&lt;-</span> pairwise_fst.d <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pairwise_fst.d)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fst_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(gdist,pairwise_fst.d_linear), <span class="fu">aes</span>(<span class="at">x=</span>gdist,<span class="at">y=</span>pairwise_fst.d)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">xlab</span>(<span class="st">"Great Circle Distance(km)"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ylab</span>(<span class="fu">expression</span>(F[<span class="st">"ST"</span>]<span class="sc">/</span><span class="dv">1</span><span class="sc">-</span>F[<span class="st">"ST"</span>]))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>fst_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"results/Fst_plot.pdf"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height=</span><span class="dv">6</span>,<span class="at">units =</span> <span class="st">"in"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="haplotype-networks" class="level1">
<h1>Haplotype Networks</h1>
<section id="pegas-haplotype-network" class="level2">
<h2 class="anchored" data-anchor-id="pegas-haplotype-network">Pegas Haplotype Network</h2>
<p>Code for haplotype network in pegas</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Haplotype Code to visualize genetic variation between populations</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">dist.dna</span>(myt_aln) <span class="co"># I think this is the right matrix to use</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span>pegas<span class="sc">::</span><span class="fu">haplotype</span>(myt_aln)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">sort</span>(h,<span class="at">what=</span><span class="st">"label"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>net<span class="ot">&lt;-</span>pegas<span class="sc">::</span><span class="fu">haploNet</span>(h)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#net&lt;-pegas::mst(h)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>utils<span class="sc">::</span><span class="fu">stack</span>(<span class="fu">setNames</span>(<span class="fu">attr</span>(h,<span class="st">"index"</span>),<span class="fu">rownames</span>(h)))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i[<span class="fu">order</span>(i<span class="sc">$</span>values),]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ind.hap<span class="ot">&lt;-</span><span class="fu">table</span>(<span class="at">hap=</span>i<span class="sc">$</span>ind, <span class="at">pop=</span>loc)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ghost.stories<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkslategrey"</span>,<span class="st">"darkslateblue"</span>, <span class="st">"blue4"</span>, <span class="st">"royalblue4"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"royalblue1"</span>, <span class="st">"skyblue4"</span>,<span class="st">"mediumseagreen"</span>,<span class="st">"darkslateblue"</span>,<span class="st">"firebrick"</span>,<span class="st">"coral"</span>,<span class="st">"darkorange3"</span>,<span class="st">"darkorange"</span>,<span class="st">"gold2"</span>,<span class="st">"gold"</span>,<span class="st">"yellow1"</span>,<span class="st">"moccasin"</span>,<span class="st">"lightskyblue1"</span>,<span class="st">"lightcyan1"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>lajolla <span class="ot">&lt;-</span> <span class="fu">sequential_hcl</span>(<span class="dv">23</span>, <span class="at">palette =</span> <span class="st">"Lajolla"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>ind.hap <span class="ot">&lt;-</span> ind.hap[,<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">13</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">17</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">4</span>,<span class="dv">19</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">14</span>,<span class="dv">9</span>)]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>ind.hap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           pop
hap         Kayak Island El Zeppelin Bamfield Playa Encantada Cape Arago
  C                    0           0        0               0          0
  CI                   0           0        0               0          0
  CII                  0           0        0               0          0
  CIII                 0           0        0               0          0
  CIV                  0           0        0               0          0
  CIX                  0           0        0               0          0
  CL                   0           1        0               0          0
  CLI                  0           1        0               0          0
  CLII                 0           1        0               0          0
  CLIII                0           0        0               0          0
  CLIV                 0           0        0               0          0
  CLIX                 0           0        0               0          0
  CLV                  0           0        0               0          0
  CLVI                 0           0        0               0          0
  CLVII                0           0        0               0          0
  CLVIII               0           0        0               0          0
  CLX                  0           0        0               0          0
  CLXI                 0           0        0               0          0
  CLXII                0           0        0               0          0
  CLXIII               0           0        0               0          0
  CLXIV                0           0        0               0          0
  CLXIX                0           0        0               0          0
  CLXV                 0           0        0               0          0
  CLXVI                0           0        0               0          0
  CLXVII               0           0        0               0          0
  CLXVIII              0           0        0               0          0
  CLXX                 0           0        0               0          0
  CLXXI                0           0        0               0          0
  CLXXII               0           0        0               0          0
  CLXXIII              0           0        0               0          0
  CLXXIV               0           0        0               0          0
  CLXXIX               0           0        0               0          0
  CLXXV                0           0        0               0          0
  CLXXVI               0           0        0               0          0
  CLXXVII              0           0        0               0          0
  CLXXVIII             0           0        0               0          0
  CLXXX                0           0        0               0          0
  CLXXXI               0           0        0               0          0
  CLXXXII              0           0        0               0          0
  CLXXXIII             0           0        0               0          0
  CLXXXIV              0           0        0               0          0
  CLXXXIX              0           0        0               0          0
  CLXXXV               0           0        0               0          0
  CLXXXVI              0           0        0               0          0
  CLXXXVII             0           0        0               0          0
  CLXXXVIII            0           0        0               0          0
  CV                   0           0        0               0          0
  CVI                  0           0        0               0          0
  CVII                 0           0        0               0          0
  CVIII                0           0        0               0          0
  CX                   0           0        0               0          0
  CXC                  0           0        0               0          0
  CXCI                 0           0        0               0          0
  CXCII                0           0        0               0          0
  CXCIII               0           0        0               0          0
  CXI                  0           0        0               0          0
  CXII                 0           0        0               0          0
  CXIII                0           1        0               0          0
  CXIV                 0           0        0               0          0
  CXIX                 0           0        0               0          0
  CXL                  0           0        0               1          0
  CXLI                 0           0        0               1          0
  CXLII                0           0        0               1          0
  CXLIII               0           0        0               1          0
  CXLIV                0           0        0               1          0
  CXLIX                0           1        0               0          0
  CXLV                 0           0        0               1          0
  CXLVI                0           0        0               1          0
  CXLVII               0           1        0               0          0
  CXLVIII              0           1        0               0          0
  CXV                  0           0        0               0          0
  CXVI                 0           0        0               0          0
  CXVII                0           0        0               0          0
  CXVIII               0           0        0               0          0
  CXX                  0           0        0               0          0
  CXXI                 0           0        0               0          0
  CXXII                0           0        0               0          0
  CXXIII               0           0        0               0          0
  CXXIV                0           0        0               0          0
  CXXIX                0           0        0               0          0
  CXXV                 0           0        0               0          0
  CXXVI                0           0        0               0          0
  CXXVII               0           0        0               0          0
  CXXVIII              0           0        0               0          0
  CXXX                 0           0        0               0          0
  CXXXI                0           0        0               0          0
  CXXXII               0           0        0               0          0
  CXXXIII              0           0        0               0          0
  CXXXIV               0           0        0               0          0
  CXXXIX               0           0        0               1          0
  CXXXV                0           0        0               1          0
  CXXXVI               0           0        0               1          0
  CXXXVII              0           0        0               1          0
  CXXXVIII             0           0        0               1          0
  I                    9          10        4               4          2
  II                   1           0        0               0          0
  III                  3           3        5               5          3
  IV                   1           0        0               0          0
  IX                   1           0        0               0          0
  L                    0           0        0               0          1
  LI                   0           0        0               1          1
  LII                  0           0        0               0          1
  LIII                 0           0        0               0          1
  LIV                  0           0        0               0          1
  LIX                  0           0        0               0          0
  LV                   0           0        0               0          1
  LVI                  0           0        0               0          1
  LVII                 0           0        0               0          1
  LVIII                0           0        0               0          1
  LX                   0           0        0               1          0
  LXI                  0           0        0               1          0
  LXII                 0           0        0               0          0
  LXIII                0           0        0               1          0
  LXIV                 0           0        0               0          0
  LXIX                 0           0        0               0          0
  LXV                  0           0        0               0          0
  LXVI                 0           0        0               0          0
  LXVII                0           0        0               0          0
  LXVIII               0           0        0               0          0
  LXX                  0           0        0               0          0
  LXXI                 0           0        0               0          0
  LXXII                0           0        0               0          0
  LXXIII               0           0        0               0          0
  LXXIV                0           0        0               0          0
  LXXIX                0           0        0               0          0
  LXXV                 0           0        0               0          0
  LXXVI                0           0        0               0          0
  LXXVII               0           0        0               0          0
  LXXVIII              0           0        0               0          0
  LXXX                 0           0        0               0          0
  LXXXI                0           1        0               0          0
  LXXXII               0           0        0               0          0
  LXXXIII              0           0        0               0          0
  LXXXIV               0           0        0               0          0
  LXXXIX               0           0        0               0          0
  LXXXV                0           0        0               0          0
  LXXXVI               0           0        0               0          0
  LXXXVII              0           0        0               0          0
  LXXXVIII             0           0        0               0          0
  V                    1           0        0               0          0
  VI                   1           0        1               0          0
  VII                  1           0        0               0          0
  VIII                 1           1        0               1          0
  X                    1           1        0               0          0
  XC                   0           0        0               0          0
  XCI                  0           0        0               0          0
  XCII                 0           0        0               0          0
  XCIII                0           0        0               0          0
  XCIV                 0           0        0               0          0
  XCIX                 0           0        0               0          0
  XCV                  0           0        0               0          0
  XCVI                 0           0        0               0          0
  XCVII                0           0        0               0          0
  XCVIII               0           0        0               0          0
  XI                   0           0        0               0          0
  XII                  0           0        0               0          0
  XIII                 0           0        0               0          0
  XIV                  0           0        0               0          0
  XIX                  0           0        0               0          0
  XL                   0           0        0               0          0
  XLI                  0           0        0               0          0
  XLII                 0           0        0               0          0
  XLIII                0           0        0               0          0
  XLIV                 0           0        0               0          0
  XLIX                 0           0        0               0          1
  XLV                  0           0        0               0          0
  XLVI                 0           0        0               0          0
  XLVII                0           0        0               0          0
  XLVIII               0           0        0               0          1
  XV                   0           0        0               0          0
  XVI                  0           0        0               0          0
  XVII                 0           0        0               0          0
  XVIII                0           0        0               0          0
  XX                   0           0        0               0          0
  XXI                  0           0        0               0          0
  XXII                 0           0        0               0          0
  XXIII                0           0        0               0          0
  XXIV                 0           0        1               0          0
  XXIX                 0           0        1               0          0
  XXV                  0           0        1               0          0
  XXVI                 0           0        1               0          0
  XXVII                0           0        1               0          0
  XXVIII               0           0        1               2          0
  XXX                  0           0        1               0          0
  XXXI                 0           0        1               0          0
  XXXII                0           0        1               0          0
  XXXIII               0           0        1               0          0
  XXXIV                0           2        1               0          3
  XXXIX                0           0        0               0          0
  XXXV                 0           0        1               0          1
  XXXVI                0           0        1               0          0
  XXXVII               0           0        0               0          0
  XXXVIII              0           0        0               0          0
           pop
hap         Enderts Beach Punta Clara Punta San Carlos Bodega Head
  C                     0           0                0           0
  CI                    0           0                0           0
  CII                   0           0                0           0
  CIII                  0           0                0           0
  CIV                   0           0                0           0
  CIX                   0           0                0           0
  CL                    0           0                0           0
  CLI                   0           0                0           0
  CLII                  0           0                0           0
  CLIII                 0           1                0           0
  CLIV                  0           1                0           0
  CLIX                  0           1                0           0
  CLV                   0           1                0           0
  CLVI                  0           1                0           0
  CLVII                 0           1                0           0
  CLVIII                0           1                0           0
  CLX                   0           1                0           0
  CLXI                  0           0                0           0
  CLXII                 0           0                0           0
  CLXIII                0           0                0           0
  CLXIV                 0           0                0           0
  CLXIX                 0           0                1           0
  CLXV                  0           0                0           0
  CLXVI                 0           0                1           0
  CLXVII                0           0                1           0
  CLXVIII               0           0                1           0
  CLXX                  0           0                1           0
  CLXXI                 0           0                1           0
  CLXXII                0           0                1           0
  CLXXIII               0           0                1           0
  CLXXIV                0           0                1           0
  CLXXIX                0           0                0           0
  CLXXV                 0           0                1           0
  CLXXVI                0           0                0           0
  CLXXVII               0           0                0           0
  CLXXVIII              0           0                0           0
  CLXXX                 0           0                0           0
  CLXXXI                0           0                0           0
  CLXXXII               0           0                0           0
  CLXXXIII              0           0                0           0
  CLXXXIV               0           0                0           0
  CLXXXIX               0           0                0           0
  CLXXXV                0           0                0           0
  CLXXXVI               0           0                0           0
  CLXXXVII              0           0                0           0
  CLXXXVIII             0           0                0           0
  CV                    0           0                0           0
  CVI                   0           0                0           0
  CVII                  0           0                0           0
  CVIII                 0           0                0           0
  CX                    0           0                0           0
  CXC                   0           0                0           0
  CXCI                  0           0                0           0
  CXCII                 0           0                0           0
  CXCIII                0           0                0           0
  CXI                   0           0                0           0
  CXII                  0           0                0           0
  CXIII                 0           0                0           0
  CXIV                  0           0                0           0
  CXIX                  0           0                0           0
  CXL                   0           0                0           0
  CXLI                  0           0                0           0
  CXLII                 0           0                0           0
  CXLIII                0           0                0           0
  CXLIV                 0           0                0           0
  CXLIX                 0           0                0           0
  CXLV                  0           0                0           0
  CXLVI                 0           0                0           0
  CXLVII                0           0                0           0
  CXLVIII               0           0                0           0
  CXV                   0           0                0           0
  CXVI                  0           0                0           0
  CXVII                 0           0                0           0
  CXVIII                0           0                0           0
  CXX                   0           0                0           0
  CXXI                  0           0                0           0
  CXXII                 0           0                0           0
  CXXIII                0           0                1           0
  CXXIV                 0           0                0           0
  CXXIX                 0           0                0           0
  CXXV                  0           0                0           0
  CXXVI                 0           0                0           0
  CXXVII                0           0                0           0
  CXXVIII               0           0                0           0
  CXXX                  0           0                0           0
  CXXXI                 0           0                0           0
  CXXXII                0           0                0           0
  CXXXIII               0           0                0           0
  CXXXIV                0           0                0           0
  CXXXIX                0           0                0           0
  CXXXV                 0           0                0           0
  CXXXVI                0           0                0           0
  CXXXVII               0           0                0           0
  CXXXVIII              0           0                0           0
  I                     3           9                7           0
  II                    0           0                0           0
  III                   2           6                2           1
  IV                    0           0                1           0
  IX                    0           1                0           0
  L                     0           1                0           0
  LI                    0           2                0           0
  LII                   0           0                0           0
  LIII                  0           0                0           0
  LIV                   0           1                0           0
  LIX                   1           0                0           0
  LV                    0           0                0           0
  LVI                   0           0                0           0
  LVII                  0           0                0           0
  LVIII                 0           0                0           0
  LX                    1           0                0           0
  LXI                   2           0                0           0
  LXII                  1           0                0           0
  LXIII                 2           1                0           1
  LXIV                  1           0                0           0
  LXIX                  0           0                0           0
  LXV                   1           0                0           0
  LXVI                  1           0                0           0
  LXVII                 1           0                0           0
  LXVIII                1           0                0           0
  LXX                   0           0                0           0
  LXXI                  0           0                0           0
  LXXII                 0           0                2           0
  LXXIII                0           0                0           0
  LXXIV                 0           0                0           0
  LXXIX                 0           0                0           0
  LXXV                  0           0                0           0
  LXXVI                 0           0                0           0
  LXXVII                0           0                0           0
  LXXVIII               0           0                0           0
  LXXX                  0           0                0           0
  LXXXI                 0           0                1           0
  LXXXII                0           0                0           0
  LXXXIII               0           0                0           0
  LXXXIV                0           0                0           0
  LXXXIX                0           0                0           1
  LXXXV                 0           1                0           1
  LXXXVI                0           0                0           1
  LXXXVII               0           0                0           1
  LXXXVIII              0           0                0           1
  V                     0           0                0           0
  VI                    0           0                0           0
  VII                   0           0                0           0
  VIII                  1           1                1           0
  X                     0           0                1           0
  XC                    0           0                0           1
  XCI                   0           0                0           1
  XCII                  0           0                0           1
  XCIII                 0           0                0           1
  XCIV                  0           0                0           0
  XCIX                  0           0                0           0
  XCV                   0           0                0           0
  XCVI                  0           0                0           0
  XCVII                 0           0                0           0
  XCVIII                0           0                0           0
  XI                    0           0                0           0
  XII                   0           0                0           0
  XIII                  0           0                0           0
  XIV                   0           0                0           0
  XIX                   0           1                1           0
  XL                    0           0                0           0
  XLI                   0           0                0           0
  XLII                  0           2                0           0
  XLIII                 0           0                0           0
  XLIV                  0           0                0           0
  XLIX                  0           0                0           0
  XLV                   0           0                0           0
  XLVI                  0           0                0           0
  XLVII                 0           0                0           0
  XLVIII                0           0                0           0
  XV                    0           0                0           0
  XVI                   0           0                0           0
  XVII                  0           0                0           0
  XVIII                 0           0                0           0
  XX                    0           0                0           0
  XXI                   0           0                0           0
  XXII                  0           0                0           0
  XXIII                 0           0                1           0
  XXIV                  0           0                0           0
  XXIX                  0           0                0           0
  XXV                   0           0                0           0
  XXVI                  0           0                0           0
  XXVII                 0           0                0           0
  XXVIII                0           0                0           0
  XXX                   0           0                0           0
  XXXI                  0           0                0           0
  XXXII                 0           0                0           0
  XXXIII                0           0                0           0
  XXXIV                 1           2                0           0
  XXXIX                 0           0                0           0
  XXXV                  1           0                0           0
  XXXVI                 0           0                0           0
  XXXVII                0           0                0           0
  XXXVIII               0           0                0           0
           pop
hap         Davenport Landing Punta Lobos Hazard Reef Punta Baja Carpinteria
  C                         0           0           0          0           0
  CI                        0           0           0          0           0
  CII                       0           0           0          0           0
  CIII                      0           1           0          0           0
  CIV                       0           0           0          0           0
  CIX                       0           0           1          0           1
  CL                        0           0           0          0           0
  CLI                       0           0           0          0           0
  CLII                      0           0           0          0           0
  CLIII                     0           0           0          0           0
  CLIV                      0           0           0          0           0
  CLIX                      0           0           0          0           0
  CLV                       0           0           0          0           0
  CLVI                      0           0           0          0           0
  CLVII                     0           0           0          0           0
  CLVIII                    0           0           0          0           0
  CLX                       0           0           0          0           0
  CLXI                      0           0           0          1           0
  CLXII                     0           0           0          1           0
  CLXIII                    0           0           0          1           0
  CLXIV                     0           0           0          1           0
  CLXIX                     0           0           0          0           0
  CLXV                      0           0           0          1           0
  CLXVI                     0           0           0          0           0
  CLXVII                    0           0           0          0           0
  CLXVIII                   0           0           0          0           0
  CLXX                      0           0           0          0           0
  CLXXI                     0           0           0          0           0
  CLXXII                    0           0           0          0           0
  CLXXIII                   0           0           0          0           0
  CLXXIV                    0           0           0          0           0
  CLXXIX                    0           0           0          0           0
  CLXXV                     0           0           0          0           0
  CLXXVI                    0           0           0          0           0
  CLXXVII                   0           0           0          0           0
  CLXXVIII                  0           0           0          0           0
  CLXXX                     0           0           0          0           0
  CLXXXI                    0           0           0          0           0
  CLXXXII                   0           0           0          0           0
  CLXXXIII                  0           0           0          0           0
  CLXXXIV                   0           0           0          0           0
  CLXXXIX                   0           1           0          0           0
  CLXXXV                    0           1           0          0           0
  CLXXXVI                   0           1           0          0           0
  CLXXXVII                  0           1           0          0           0
  CLXXXVIII                 0           1           0          0           0
  CV                        0           0           0          0           0
  CVI                       0           0           0          0           0
  CVII                      0           0           0          0           0
  CVIII                     0           0           1          0           0
  CX                        0           0           1          0           0
  CXC                       0           1           0          0           0
  CXCI                      0           1           0          0           0
  CXCII                     0           1           0          0           0
  CXCIII                    0           1           0          0           0
  CXI                       0           0           1          0           0
  CXII                      0           0           1          0           0
  CXIII                     0           0           1          1           0
  CXIV                      0           0           1          0           0
  CXIX                      0           0           0          0           0
  CXL                       0           0           0          0           0
  CXLI                      0           0           0          0           0
  CXLII                     0           0           0          0           0
  CXLIII                    0           0           0          0           0
  CXLIV                     0           0           0          0           0
  CXLIX                     0           0           0          0           0
  CXLV                      0           0           0          0           0
  CXLVI                     0           0           0          1           0
  CXLVII                    0           0           0          0           0
  CXLVIII                   0           0           0          0           0
  CXV                       0           0           1          0           0
  CXVI                      0           0           1          0           0
  CXVII                     0           0           0          0           0
  CXVIII                    0           0           0          0           1
  CXX                       0           0           0          0           0
  CXXI                      0           0           0          0           0
  CXXII                     0           0           0          0           0
  CXXIII                    0           0           0          0           1
  CXXIV                     0           0           0          0           1
  CXXIX                     0           0           0          0           0
  CXXV                      0           0           0          1           2
  CXXVI                     0           0           0          0           1
  CXXVII                    0           0           0          0           1
  CXXVIII                   0           1           0          0           0
  CXXX                      0           0           0          0           0
  CXXXI                     0           0           0          0           0
  CXXXII                    0           0           0          0           0
  CXXXIII                   0           0           0          0           0
  CXXXIV                    0           0           0          0           0
  CXXXIX                    0           0           0          0           0
  CXXXV                     0           0           0          0           0
  CXXXVI                    0           0           0          0           0
  CXXXVII                   0           0           0          0           0
  CXXXVIII                  0           0           0          0           0
  I                         1           8          11         10           4
  II                        0           0           0          0           0
  III                       3           6           2          2           1
  IV                        0           0           0          0           0
  IX                        0           1           0          0           1
  L                         0           0           0          0           0
  LI                        0           0           0          0           0
  LII                       0           0           0          0           0
  LIII                      0           0           0          0           0
  LIV                       0           0           0          0           1
  LIX                       0           0           0          0           0
  LV                        0           0           0          0           0
  LVI                       0           0           0          0           0
  LVII                      0           0           0          0           0
  LVIII                     0           0           0          0           0
  LX                        1           0           0          0           0
  LXI                       1           0           0          0           0
  LXII                      0           0           0          0           0
  LXIII                     0           0           0          0           0
  LXIV                      0           0           0          0           0
  LXIX                      0           0           0          0           0
  LXV                       0           0           0          0           0
  LXVI                      0           0           0          0           0
  LXVII                     0           0           0          0           0
  LXVIII                    0           0           0          0           0
  LXX                       0           0           0          0           0
  LXXI                      0           0           0          0           0
  LXXII                     1           1           0          1           1
  LXXIII                    0           0           0          0           0
  LXXIV                     0           0           0          0           0
  LXXIX                     0           0           0          0           0
  LXXV                      0           0           0          0           0
  LXXVI                     0           0           0          0           0
  LXXVII                    0           0           0          0           0
  LXXVIII                   0           0           0          0           0
  LXXX                      0           0           0          0           0
  LXXXI                     0           1           0          0           1
  LXXXII                    0           0           0          0           0
  LXXXIII                   0           0           0          0           0
  LXXXIV                    0           0           0          0           0
  LXXXIX                    0           0           0          0           0
  LXXXV                     0           0           0          0           0
  LXXXVI                    0           0           0          0           0
  LXXXVII                   0           0           0          0           0
  LXXXVIII                  0           0           0          0           0
  V                         0           0           0          0           0
  VI                        0           0           0          0           0
  VII                       2           0           0          0           0
  VIII                      0           0           0          0           0
  X                         1           0           0          1           0
  XC                        0           0           0          0           0
  XCI                       0           0           0          0           0
  XCII                      0           0           0          0           0
  XCIII                     0           0           0          0           0
  XCIV                      1           0           0          0           0
  XCIX                      0           0           0          0           0
  XCV                       1           0           0          0           0
  XCVI                      1           0           0          0           0
  XCVII                     1           0           0          0           0
  XCVIII                    1           0           0          0           0
  XI                        0           0           0          0           0
  XII                       0           0           0          0           0
  XIII                      0           0           0          0           0
  XIV                       0           0           0          0           0
  XIX                       0           0           0          0           0
  XL                        0           0           0          0           0
  XLI                       0           0           0          0           0
  XLII                      0           0           0          0           0
  XLIII                     0           0           0          0           0
  XLIV                      0           0           0          0           0
  XLIX                      1           1           1          0           0
  XLV                       0           0           0          0           0
  XLVI                      0           0           0          0           0
  XLVII                     0           0           0          0           0
  XLVIII                    0           0           0          0           0
  XV                        0           0           0          0           0
  XVI                       0           0           0          0           0
  XVII                      0           0           0          0           0
  XVIII                     0           0           0          0           0
  XX                        0           0           0          0           0
  XXI                       0           0           0          0           0
  XXII                      0           0           0          0           0
  XXIII                     0           0           0          0           1
  XXIV                      0           0           0          0           0
  XXIX                      0           0           0          0           0
  XXV                       0           0           0          0           0
  XXVI                      0           0           0          0           0
  XXVII                     0           0           0          0           0
  XXVIII                    1           0           0          0           0
  XXX                       0           0           0          0           0
  XXXI                      0           0           0          0           1
  XXXII                     0           0           0          0           0
  XXXIII                    0           0           0          0           0
  XXXIV                     0           0           0          1           0
  XXXIX                     0           0           0          0           0
  XXXV                      0           0           0          2           0
  XXXVI                     0           0           0          0           0
  XXXVII                    0           0           0          0           0
  XXXVIII                   0           0           0          0           0
           pop
hap         Refugio Beach La Jolla Elfin Cove Port Renfrew Faro San Jose
  C                     0        0          0            0             0
  CI                    0        0          0            0             0
  CII                   0        0          0            0             0
  CIII                  0        0          0            0             0
  CIV                   0        0          0            0             0
  CIX                   0        0          0            0             0
  CL                    0        0          0            0             0
  CLI                   0        0          0            0             0
  CLII                  0        0          0            0             0
  CLIII                 0        0          0            0             0
  CLIV                  0        0          0            0             0
  CLIX                  0        0          0            0             0
  CLV                   0        0          0            0             0
  CLVI                  0        0          0            0             0
  CLVII                 0        0          0            0             0
  CLVIII                0        0          0            0             0
  CLX                   0        0          0            0             0
  CLXI                  0        0          0            0             0
  CLXII                 0        0          0            0             0
  CLXIII                0        0          0            0             0
  CLXIV                 0        0          0            0             0
  CLXIX                 0        0          0            0             0
  CLXV                  0        0          0            0             0
  CLXVI                 0        0          0            0             0
  CLXVII                0        0          0            0             0
  CLXVIII               0        0          0            0             0
  CLXX                  0        0          0            0             0
  CLXXI                 0        0          0            0             0
  CLXXII                0        0          0            0             0
  CLXXIII               0        0          0            0             0
  CLXXIV                0        0          0            0             0
  CLXXIX                0        0          0            0             1
  CLXXV                 0        0          0            0             0
  CLXXVI                0        0          0            0             1
  CLXXVII               0        0          0            0             1
  CLXXVIII              0        0          0            0             1
  CLXXX                 0        0          0            0             1
  CLXXXI                0        0          0            0             1
  CLXXXII               0        0          0            0             1
  CLXXXIII              0        0          0            0             1
  CLXXXIV               0        0          0            0             2
  CLXXXIX               0        0          0            0             0
  CLXXXV                0        0          0            0             0
  CLXXXVI               0        0          0            0             0
  CLXXXVII              0        0          0            0             0
  CLXXXVIII             0        0          0            0             0
  CV                    0        0          0            0             0
  CVI                   0        0          0            0             0
  CVII                  0        0          0            0             0
  CVIII                 0        0          0            0             0
  CX                    0        0          0            0             0
  CXC                   0        0          0            0             0
  CXCI                  0        0          0            0             0
  CXCII                 0        0          0            0             0
  CXCIII                0        0          0            0             0
  CXI                   0        0          0            0             0
  CXII                  0        0          0            0             0
  CXIII                 0        0          0            0             1
  CXIV                  0        0          0            0             0
  CXIX                  1        0          0            0             0
  CXL                   0        0          0            0             0
  CXLI                  0        0          0            0             0
  CXLII                 0        0          0            0             0
  CXLIII                0        0          0            0             0
  CXLIV                 0        0          0            0             0
  CXLIX                 0        0          0            0             0
  CXLV                  0        0          0            0             1
  CXLVI                 0        0          0            0             0
  CXLVII                0        0          0            0             0
  CXLVIII               0        0          0            0             0
  CXV                   0        0          0            0             0
  CXVI                  0        0          0            0             0
  CXVII                 1        0          0            0             0
  CXVIII                1        0          0            0             0
  CXX                   1        0          0            0             0
  CXXI                  2        0          0            0             0
  CXXII                 1        0          0            0             0
  CXXIII                0        0          0            0             0
  CXXIV                 0        0          0            0             0
  CXXIX                 0        0          0            0             0
  CXXV                  0        0          0            0             0
  CXXVI                 0        0          0            0             0
  CXXVII                0        0          0            0             0
  CXXVIII               0        0          0            0             0
  CXXX                  0        0          0            0             0
  CXXXI                 0        1          0            0             0
  CXXXII                0        2          0            0             0
  CXXXIII               0        1          0            0             0
  CXXXIV                0        1          0            0             0
  CXXXIX                0        0          0            0             0
  CXXXV                 0        0          0            0             0
  CXXXVI                0        0          0            0             0
  CXXXVII               0        0          0            0             0
  CXXXVIII              0        0          0            0             0
  I                     4        1          3            1             3
  II                    0        0          0            0             0
  III                   0        0          1            1             4
  IV                    0        0          0            0             0
  IX                    0        0          2            0             0
  L                     0        0          0            0             0
  LI                    0        0          0            0             0
  LII                   0        0          0            0             0
  LIII                  0        0          0            0             0
  LIV                   0        0          0            0             0
  LIX                   0        0          0            0             0
  LV                    0        0          0            0             0
  LVI                   0        0          0            0             0
  LVII                  0        0          0            0             0
  LVIII                 0        0          0            0             0
  LX                    0        0          0            0             0
  LXI                   0        0          0            0             0
  LXII                  0        0          0            0             0
  LXIII                 0        0          0            0             0
  LXIV                  0        0          0            0             0
  LXIX                  0        0          0            0             0
  LXV                   0        0          0            0             0
  LXVI                  0        0          0            0             0
  LXVII                 0        0          0            0             1
  LXVIII                0        0          0            0             0
  LXX                   0        0          0            0             0
  LXXI                  0        0          0            0             0
  LXXII                 0        0          0            0             0
  LXXIII                1        1          0            0             0
  LXXIV                 0        0          0            0             0
  LXXIX                 0        0          0            0             0
  LXXV                  0        0          0            0             0
  LXXVI                 0        0          0            0             0
  LXXVII                0        0          0            0             0
  LXXVIII               0        0          0            0             0
  LXXX                  0        0          0            0             0
  LXXXI                 0        0          0            0             2
  LXXXII                0        0          0            0             0
  LXXXIII               0        0          0            0             0
  LXXXIV                0        0          0            0             0
  LXXXIX                0        0          0            0             0
  LXXXV                 0        0          0            0             0
  LXXXVI                0        0          0            0             0
  LXXXVII               0        0          0            0             0
  LXXXVIII              0        0          0            0             0
  V                     0        0          0            0             0
  VI                    0        0          0            0             0
  VII                   1        0          0            0             0
  VIII                  0        1          0            1             0
  X                     1        0          0            0             0
  XC                    0        0          0            0             0
  XCI                   0        0          0            0             0
  XCII                  0        0          0            0             0
  XCIII                 0        0          0            0             0
  XCIV                  0        0          0            0             0
  XCIX                  0        0          0            0             0
  XCV                   0        0          0            0             1
  XCVI                  0        0          0            0             0
  XCVII                 0        0          0            0             0
  XCVIII                0        0          0            0             0
  XI                    0        0          1            0             0
  XII                   0        0          1            0             0
  XIII                  0        0          1            0             0
  XIV                   0        0          1            0             0
  XIX                   0        0          1            0             1
  XL                    0        0          0            1             0
  XLI                   0        0          0            1             0
  XLII                  0        0          0            1             0
  XLIII                 0        0          0            1             0
  XLIV                  0        0          0            1             0
  XLIX                  0        0          0            0             0
  XLV                   0        0          0            1             0
  XLVI                  0        0          0            1             0
  XLVII                 0        0          0            1             0
  XLVIII                0        0          0            0             0
  XV                    0        0          1            0             0
  XVI                   0        0          1            0             0
  XVII                  0        0          1            0             0
  XVIII                 0        0          1            0             0
  XX                    0        0          1            0             0
  XXI                   0        0          1            0             1
  XXII                  0        0          1            0             0
  XXIII                 0        0          1            0             0
  XXIV                  0        0          0            0             0
  XXIX                  0        0          0            0             0
  XXV                   0        0          0            0             0
  XXVI                  0        0          0            0             0
  XXVII                 0        0          0            0             0
  XXVIII                0        0          0            0             0
  XXX                   1        0          0            0             0
  XXXI                  0        0          0            0             0
  XXXII                 0        0          0            0             0
  XXXIII                0        0          0            0             0
  XXXIV                 0        0          0            1             1
  XXXIX                 0        0          0            1             0
  XXXV                  1        0          0            0             0
  XXXVI                 0        0          0            0             0
  XXXVII                0        0          0            1             0
  XXXVIII               0        0          0            1             0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf(file = "modified_haplotype.pdf", width = 8.5, height = 11)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(net,size=(attr(net,"freq")/5),scale.ratio=2.25,pie=ind.hap,legend=F,labels=F,threshold=0,show.mutation=2,bg=lajolla,pch=19,ncol=1,cex=0.85)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#legend("topleft",colnames(ind.hap),col=ghost.stories,pch=19,ncol=1,cex=0.85)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="popart" class="level2">
<h2 class="anchored" data-anchor-id="popart">PopArt</h2>
<p>Code for preparing for PopArt.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>hapseqs<span class="ot">&lt;-</span>h[] <span class="co"># pull out the DNAbin object from the haplotype object #write this to nexus format</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.nexus.data</span>(hapseqs,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file=</span><span class="st">"popart/mcali_haplotypes.nex"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">interleaved=</span>F) <span class="co">#write both haplotype tables to csv</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ind.hap, <span class="at">file=</span><span class="st">"popart/mcali_table.csv"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">quote=</span>F)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#write the flattened metadata too.</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(events, <span class="at">file=</span><span class="st">"mcali_event_metadata.csv"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">quote=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="migrate" class="level1">
<h1>Migrate</h1>
<section id="preparing-the-data-for-migrate" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-data-for-migrate">Preparing the data for migrate</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to Phangorn</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>myt_phy <span class="ot">&lt;-</span> <span class="fu">phyDat</span>(myt_aln)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a Jukes-Cantor distance matrix from all sequences</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>dm <span class="ot">&lt;-</span> <span class="fu">dist.ml</span>(myt_phy, <span class="at">model =</span><span class="st">"JC69"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create a neighbor-joining tree from the distance matrix</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">NJ</span>(dm)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mcali_modeltest<span class="ot">&lt;-</span><span class="fu">modelTest</span>(myt_phy, tree,<span class="at">G=</span>T, <span class="at">I=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JC"
[1] "JC+G"
[1] "F81"
[1] "F81+G"
[1] "K80"
[1] "K80+G"
[1] "HKY"
[1] "HKY+G"
[1] "TrNe"
[1] "TrNe+G"
[1] "TrN"
[1] "TrN+G"
[1] "TPM1"
[1] "TPM1+G"
[1] "K81"
[1] "K81+G"
[1] "TPM1u"
[1] "TPM1u+G"
[1] "TPM2"
[1] "TPM2+G"
[1] "TPM2u"
[1] "TPM2u+G"
[1] "TPM3"
[1] "TPM3+G"
[1] "TPM3u"
[1] "TPM3u+G"
[1] "TIM1e"
[1] "TIM1e+G"
[1] "TIM1"
[1] "TIM1+G"
[1] "TIM2e"
[1] "TIM2e+G"
[1] "TIM2"
[1] "TIM2+G"
[1] "TIM3e"
[1] "TIM3e+G"
[1] "TIM3"
[1] "TIM3+G"
[1] "TVMe"
[1] "TVMe+G"
[1] "TVM"
[1] "TVM+G"
[1] "SYM"
[1] "SYM+G"
[1] "GTR"
[1] "GTR+G"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mcali_modeltest<span class="ot">&lt;-</span>mcali_modeltest[<span class="fu">order</span>(mcali_modeltest<span class="sc">$</span>BIC),]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mcali_modeltest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["AICw"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["AICc"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["AICcw"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"TIM1+G(4)","2":"954","3":"-2341.444","4":"6590.889","5":"4.679281e-01","6":"NaN","7":"NaN","8":"10572.68","_rn_":"30"},{"1":"TIM3+G(4)","2":"954","3":"-2342.171","4":"6592.341","5":"2.263709e-01","6":"NaN","7":"NaN","8":"10574.13","_rn_":"38"},{"1":"TrN+G(4)","2":"953","3":"-2345.811","4":"6597.623","5":"1.614070e-02","6":"NaN","7":"NaN","8":"10575.24","_rn_":"12"},{"1":"TIM2+G(4)","2":"954","3":"-2345.778","4":"6599.556","5":"6.137808e-03","6":"NaN","7":"NaN","8":"10581.35","_rn_":"34"},{"1":"GTR+G(4)","2":"956","3":"-2339.946","4":"6591.892","5":"2.834217e-01","6":"NaN","7":"NaN","8":"10582.03","_rn_":"46"},{"1":"TPM1u+G(4)","2":"953","3":"-2356.215","4":"6618.430","5":"4.894087e-07","6":"NaN","7":"NaN","8":"10596.05","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Some funky code to get the gamma shape parameter, and discrete rates</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this is one way - reach into the environment </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">attr</span>(mcali_modeltest, <span class="st">"env"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>TIM1 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="st">"TIM1+G(4)"</span>, env)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#eval(HKY, env=env)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="fl">0.26375833217876</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># here's the other way - as.pml()</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>mcali_pml <span class="ot">&lt;-</span> <span class="fu">as.pml</span>(mcali_modeltest)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>mcali_pml<span class="sc">$</span>g <span class="co"># four rate categories</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002817133 0.076806583 0.529658802 3.390717482</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mcali_pml<span class="sc">$</span>w <span class="co"># probabilities of each rate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25 0.25 0.25 0.25</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">rgamma</span>(<span class="dv">10000</span>,<span class="at">shape=</span>shape)), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>migrate_rates <span class="ot">&lt;-</span> phangorn<span class="sc">:::</span><span class="fu">discrete.gamma</span>(shape,<span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_gamma_plus_inv</span>(<span class="at">shape =</span>shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Mcali_analysis_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TiTvRatio</span>(myt_g) <span class="co">#need strataG for this</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Ti          Tv Ti.Tv.ratio 
 119.000000   41.000000    2.902439 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pml(tree = `tree_TIM1+G(4)`, data = data, bf = c(0.288481138885885, </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.160432444597162, 0.209795981107601, 0.341290435409352), Q = c(1, </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.39011701149672, 0.297813690823323, 0.297813690823323, 17.1942098908114, </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1), model = "TIM1", k = 4, shape = 0.26375833217876)</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#according to the docs for pml() bf = base frequencies, Q is the lower triangle of the rate matrix, k = number of intervals in the discrete gamma, shape=shape parameter of gamma distribution</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.39103240795265</span>, <span class="fl">0.297798914794784</span>, <span class="fl">0.297798914794784</span>, <span class="fl">17.193305668728</span>, <span class="dv">1</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>mat[<span class="fu">lower.tri</span>(mat, <span class="at">diag =</span> F)] <span class="ot">&lt;-</span> Q</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]       [,2] [,3] [,4]
[1,] 0.0000000  0.0000000    0    0
[2,] 1.0000000  0.0000000    0    0
[3,] 5.3910324  0.2977989    0    0
[4,] 0.2977989 17.1933057    1    0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format data for migrate</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write.nexus.data(myt_aln,"./migrate/mcali_migrate.nex", interleaved=F,missing="N")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>